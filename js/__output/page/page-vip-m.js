jQuery(function(a){var e=a("#cal_nowCoins"),i=a("#cal_needCoins"),n=a("#cal_days"),s=a("#editsubmit_btn"),o=a("#vip-m-nocoins"),d=a("#vip-m-nologin"),r=parseInt(a("#uid").text()),l=a("#buyVipSuccess"),p=a("#buyVipOtherFail"),u=a("#vip-m-buy");if(!r)return d.slideDown(),void s.attr("disabled","disabled").addClass("disabled");var c=function(){var a=parseInt(e.val())||0,t=parseInt(i.val())||0;return 0!==t?t>a?(o.slideDown(),!1):(o.hide(),!0):void 0}(function(){if(!a("span.govip")[0]&&a("span.amount")[0]){var e=a("span.amount").text().replace(/\s/g,""),i=parseInt(e.substr(0,4)),n=parseInt(e.substr(0,4)),s=parseInt(e.substr(8,2));if(!(isNaN(i)||isNaN(n)||isNaN(s))){{var o=new Date(i,n,s);new Date}t.getTime()-o.getTime()<864e6&&a("span.amount").addClass("tobeexpired")}}})();a(".m-days").find("label").click(function(){i.val(a(this).data("need_coins")),n.val(a(this).data("buy_days")),a(this).addClass("on").siblings("label").removeClass("on").find("input:radio[name=days]").attr("checked",!1),a(this).find("input:radio[name=days]").attr("checked",!0),n.val(a(this).find("input:radio[name=days]").val()),c()}),$showVIPDateSpan=a(".vip-m-container").find("span.ex"),$showVIPDateB=a(".vip-m-container").find("b#ex");var m=function(a){var a=parseInt(n.val()),e=0;e=$showVIPDateB[0]?new Date($showVIPDateB.html()).getTime():(new Date).getTime();var t=e+24*a*60*60*1e3,i=new Date(t),s=i.getFullYear(),o=i.getMonth()+1,d=i.getDate(),r=s+"-"+o+"-"+d;$showVIPDateB[0]?$showVIPDateB.html(r):$showVIPDateSpan.html("<em>有效期至:</em><b id='ex'>"+r+"</b>")},v=a("form#buygroupform");s.click(function(){if(p.hide(),c()){var e="home.php?mod=spacecp&ac=usergroup&do=buy&groupid=22&inajax=1",t={days:n.val()};v.find("input").each(function(){t[a(this).attr("name")]=a(this).val()}),a.post(e,t,function(e){e=e?JSON.parse(e):{},1===e.code?(u.slideUp(600),l.slideDown(600),m(n.val())):(u.slideUp(600),a("#errorCode").html(e.code+" : "+e.msg),p.slideDown())})}})});